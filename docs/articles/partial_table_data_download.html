<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-CA">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Partial table data download • cansim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Partial table data download">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-107390160-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107390160-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cansim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/cansim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/listing_cansim_tables.html">Listing Statistics Canada data tables</a>
    </li>
    <li>
      <a href="../articles/partial_table_data_download.html">Partial table data download</a>
    </li>
    <li>
      <a href="../articles/retrieving_cansim_vectors.html">Retrieving individual Statistics Canada vectors</a>
    </li>
    <li>
      <a href="../articles/working_with_hierarchies.html">Working with Statistics Canada data table object hierarchies</a>
    </li>
    <li>
      <a href="../articles/working_with_large_tables.html">Working with large tables</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Releases</li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/v0.3.8" class="external-link">Version 0.3.8</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/v0.3.7" class="external-link">Version 0.3.7</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/0.3.6" class="external-link">Version 0.3.6</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/0.3.5" class="external-link">Version 0.3.5</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/0.3.4" class="external-link">Version 0.3.4</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/0.3.2" class="external-link">Version 0.3.2</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/0.3.1" class="external-link">Version 0.3.1</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/0.3" class="external-link">Version 0.3</a>
    </li>
    <li>
      <a href="https://github.com/mountainMath/cansim/releases/tag/0.2.2" class="external-link">Version 0.2.2</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mountainMath/cansim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Partial table data download</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mountainMath/cansim/blob/HEAD/vignettes/partial_table_data_download.Rmd" class="external-link"><code>vignettes/partial_table_data_download.Rmd</code></a></small>
      <div class="hidden name"><code>partial_table_data_download.Rmd</code></div>

    </div>

    
    
<p>Sometimes one is only interested in a relatively small subset of a
large table, and instead of having to download the entire table, or just
a handful of vectors, one might want to access a substantial number of
coordinates without having to download the entire table. The package
facilitates this by</p>
<ul>
<li>allowing to create a template table using just the table metadata
that informs on the available combination of dimensions and their
coordinates, and</li>
<li>allowing to access a subset of the table using a filtered version of
the template.</li>
</ul>
<p>We demonstrate this process by taking the large Table 34-10-0285 on
building permits.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mountainMath/cansim" class="external-link">cansim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">bp_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cansim_table_template.html">get_cansim_table_template</a></span><span class="op">(</span><span class="st">"34-10-0285"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bp_template</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   cansimTableNumber COORDINATE Geography `Type of building`       `Type of work`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 34-10-0285        1.1.1.1.1  Canada    Total residential and n… Types of work…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 34-10-0285        1.1.1.1.2  Canada    Total residential and n… Types of work…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 34-10-0285        1.1.1.1.3  Canada    Total residential and n… Types of work…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 34-10-0285        1.1.1.1.4  Canada    Total residential and n… Types of work…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 34-10-0285        1.1.1.2.1  Canada    Total residential and n… Types of work…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 34-10-0285        1.1.1.2.2  Canada    Total residential and n… Types of work…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: Variables &lt;chr&gt;, `Seasonal adjustment, value type` &lt;chr&gt;</span></span></span></code></pre></div>
<p>The template gives information on the possible combinations of data
(although some combinations might not be available in the table and have
no data). We can use this to pinpoint data series we are interested in.
For the purpose of this example we want to look at the number of housing
units created and lost in the four largest metro areas in Canada.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_template_filtered</span> <span class="op">&lt;-</span> <span class="va">bp_template</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Geography</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Toronto, Ontario"</span>, <span class="st">"Montréal, Quebec"</span>, <span class="st">"Vancouver, British Columbia"</span>, <span class="st">"Calgary, Alberta"</span><span class="op">)</span>,</span>
<span>         <span class="va">`Type of building`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Total residential"</span>,<span class="st">"Total demolitions"</span><span class="op">)</span>,</span>
<span>         <span class="va">`Type of work`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Demolitions for residential dwellings"</span>,<span class="st">"Deconversion total"</span>,<span class="st">"Conversions total"</span>,<span class="st">"New dwelling units total"</span><span class="op">)</span>,</span>
<span>         <span class="va">Variables</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Number of dwelling-units created"</span>, <span class="st">"Number of dwelling-units lost"</span>, <span class="st">"Number of dwelling-units demolished"</span><span class="op">)</span>,</span>
<span>         <span class="va">`Seasonal adjustment, value type`</span> <span class="op">==</span> <span class="st">"Unadjusted, current"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">bp_template_filtered</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 7</span></span></span>
<span><span class="co">#&gt;    cansimTableNumber COORDINATE  Geography     `Type of building` `Type of work`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 34-10-0285        24.4.3.2.1  Montréal, Qu… Total residential  New dwelling …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 34-10-0285        24.4.3.3.1  Montréal, Qu… Total residential  New dwelling …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 34-10-0285        24.4.3.4.1  Montréal, Qu… Total residential  New dwelling …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 34-10-0285        24.4.16.2.1 Montréal, Qu… Total residential  Conversions t…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 34-10-0285        24.4.16.3.1 Montréal, Qu… Total residential  Conversions t…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 34-10-0285        24.4.16.4.1 Montréal, Qu… Total residential  Conversions t…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 34-10-0285        24.4.20.2.1 Montréal, Qu… Total residential  Deconversion …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 34-10-0285        24.4.20.3.1 Montréal, Qu… Total residential  Deconversion …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 34-10-0285        24.4.20.4.1 Montréal, Qu… Total residential  Deconversion …</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 34-10-0285        24.4.24.2.1 Montréal, Qu… Total residential  Demolitions f…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 86 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: Variables &lt;chr&gt;, `Seasonal adjustment, value type` &lt;chr&gt;</span></span></span></code></pre></div>
<p>To getting data for just this subset of the table we feed that into
the <code>get_cansim_data_for_table_coord_periods</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_cansim_data_for_table_coord_periods.html">get_cansim_data_for_table_coord_periods</a></span><span class="op">(</span><span class="va">bp_template_filtered</span><span class="op">)</span></span>
<span><span class="co">#&gt; Accessing CANSIM NDM vectors from Statistics Canada</span></span>
<span><span class="co">#&gt; Failed to load for 80 coordinates</span></span>
<span><span class="co">#&gt; 24.27.16.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.20.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.3.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.27.3.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.24.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 24.4.3.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.16.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.20.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.3.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.27.3.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.24.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 45.4.3.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.16.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.20.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.3.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.27.3.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.24.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 53.4.3.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.16.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.20.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.3.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.27.3.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.16.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.16.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.20.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.20.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.24.2.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.24.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.24.4.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.3.3.1.0.0.0.0.0</span></span>
<span><span class="co">#&gt; 59.4.3.4.1.0.0.0.0.0</span></span>
<span></span>
<span><span class="va">bp_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,568 × 17</span></span></span>
<span><span class="co">#&gt;    REF_DATE   Date       GEO         `Type of building` `Type of work` Variables</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2017-01-01 2017-01-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2017-02-01 2017-02-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2017-03-01 2017-03-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2017-04-01 2017-04-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2017-05-01 2017-05-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2017-06-01 2017-06-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2017-07-01 2017-07-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2017-08-01 2017-08-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2017-09-01 2017-09-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2017-10-01 2017-10-01 Montréal, … Total demolitions  Demolitions f… Number o…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,558 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more variables: `Seasonal adjustment, value type` &lt;fct&gt;, VALUE &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   val_norm &lt;dbl&gt;, SCALAR_ID &lt;int&gt;, VECTOR &lt;chr&gt;, cansimTableNumber &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   COORDINATE &lt;chr&gt;, SYMBOL &lt;int&gt;, releaseTime &lt;chr&gt;, frequencyCode &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   DECIMALS &lt;int&gt;</span></span></span></code></pre></div>
<p>We then aggregate it to annual data and plot it by year and area,
separating out dwellings newly created, created through conversion,
those lost to deconversions and those demolished.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Value<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">Variables</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Number of dwelling-units demolished"</span>,<span class="st">"Number of dwelling-units lost"</span><span class="op">)</span> <span class="op">~</span> <span class="op">-</span> <span class="va">val_norm</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">val_norm</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">", .+"</span>,<span class="st">""</span>,<span class="va">GEO</span><span class="op">)</span>,</span>
<span>         Year<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strftime</a></span><span class="op">(</span><span class="va">Date</span>,<span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>Value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>,n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,.by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Name</span>,<span class="va">Year</span>,<span class="va">`Type of work`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span><span class="op">==</span><span class="fl">12</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># only show years with complete 12 months of data</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Year</span>,y<span class="op">=</span><span class="va">Value</span>,fill<span class="op">=</span><span class="va">`Type of work`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Name</span>,scales<span class="op">=</span><span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">90</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Building permits for residential structures in Canadian metro areas"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Number of dwelling units"</span>,</span>
<span>       x<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>       fill<span class="op">=</span><span class="st">"Metric"</span>,</span>
<span>       caption<span class="op">=</span><span class="st">"StatCan Table 34-10-0285"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="partial_table_data_download_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://mountainmath.ca" class="external-link">Jens von Bergmann</a>, <a href="https://dshkol.com" class="external-link">Dmitry Shkolnik</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
