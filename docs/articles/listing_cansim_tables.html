<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Listing CANSIM tables • cansim</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Listing CANSIM tables">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cansim</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cansim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/listing_cansim_tables.html">Listing CANSIM tables</a>
    </li>
    <li>
      <a href="../articles/retrieving_cansim_vectors.html">Retrieving individual CANSIM vectors</a>
    </li>
    <li>
      <a href="../articles/working_with_hierarchies.html">Working with CANSIM hierarchies</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Listing CANSIM tables</h1>
            
            <h4 class="date">2018-10-21</h4>
      
      
      <div class="hidden name"><code>listing_cansim_tables.Rmd</code></div>

    </div>

    
    
<p>This vignette details how to use the internal table search functions in the <code>cansim</code> package with a simple example using employment data for economic regions in British Columbia.</p>
<div id="a-note-on-caching-and-refreshing-table-lists" class="section level3">
<h3 class="hasAnchor">
<a href="#a-note-on-caching-and-refreshing-table-lists" class="anchor"></a>A note on caching and refreshing table lists</h3>
<p>As the table search function requires a full scrape of Statistics Canada’s CANSIM webpage, generating this list can be quite slow so a saved list of tables is included with the package. As Statistics Canada adds additional tables and data products, the list that comes with the package will become out of date and will require refreshing. Tables can be refleshed by specifying <code>refresh=TRUE</code> when calling <code>list_cansim_tables</code>. The full list of tables can be cached locally to avoid delays and prevent unnecessary web scraping. This can (and should) be enabled by setting <code>options(cache_path="your cache path")</code> option so that table information is cached across R sessions.</p>
</div>
<div id="listing-and-filtering-tables" class="section level3">
<h3 class="hasAnchor">
<a href="#listing-and-filtering-tables" class="anchor"></a>Listing and filtering tables</h3>
<p>Calling <code>list_cansim_tables</code> returns a data frame with useful metadata for available tables. There are 21 fields of metadata for each table including title, in English and French, keyword sets, notes, and table numbers.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(cansim)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">names</span>(<span class="kw"><a href="../reference/list_cansim_tables.html">list_cansim_tables</a></span>())</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; The table won't be able to refresh if options(cache_path="your cache path") is not set.</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  [1] "title"                      "title_en"                  </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;  [3] "title_fr"                   "keywords_en"               </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;  [5] "keywords"                   "keywords_fr"               </span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;  [7] "notes"                      "notes_en"                  </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  [9] "notes_fr"                   "state"                     </span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; [11] "subject"                    "date_published"            </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; [13] "frequency"                  "revision_id"               </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; [15] "time_period_coverage_start" "time_period_coverage_end"  </span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; [17] "metadata_created"           "metadata_modified"         </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; [19] "url_en"                     "url_fr"                    </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; [21] "cansim_table_number"</span></a></code></pre></div>
<p>The appropriate table can be found by subsetting or filtering on the properties we want to use to find the appropriate tables.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; Warning: package 'dplyr' was built under R version 3.5.1</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; Attaching package: 'dplyr'</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;     filter, lag</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;     intersect, setdiff, setequal, union</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="kw"><a href="../reference/list_cansim_tables.html">list_cansim_tables</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">grepl</span>(<span class="st">"Labour force characteristics"</span>,title), <span class="kw">grepl</span>(<span class="st">"economic region"</span>,title)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="st">"cansim_table_number"</span>,<span class="st">"title"</span>)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; The table won't be able to refresh if options(cache_path="your cache path") is not set.</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt;   cansim_table_number title                                               </span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;                                               </span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; 1 14-10-0293          Labour force characteristics by economic region, th…</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; 2 14-10-0090          Labour force characteristics by province, territory…</span></a></code></pre></div>
<p>The search came up with two tables. In this example we are interested in the unemployment rate for 2015 onwards for the Lower Mainland, Vancouver Island, and Okanagan economic regions from the Labour Force Characteristics table.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">selected_table &lt;-<span class="st"> "14-10-0293"</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">data &lt;-<span class="kw"><a href="../reference/get_cansim.html">get_cansim</a></span>(selected_table) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="../reference/normalize_cansim_values.html">normalize_cansim_values</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">grepl</span>(<span class="st">"Mainland|Vancouver Island|Okanagan"</span>, GEO),</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">         Date<span class="op">&gt;=</span><span class="kw">as.Date</span>(<span class="st">"2015-01-01"</span>),</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">         <span class="st">`</span><span class="dt">Labour force characteristics</span><span class="st">`</span><span class="op">==</span><span class="st">"Unemployment rate"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(Date, GEO, Statistics, VALUE) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">spread</a></span>(<span class="dt">key=</span><span class="st">"Statistics"</span>, <span class="dt">value=</span>VALUE)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; Accessing CANSIM NDM product 14-10-0293</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; Parsing data</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; Folding in metadata</span></a></code></pre></div>
<p>We can visualize then results with <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(data, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>Date, <span class="dt">group =</span> GEO,<span class="dt">y=</span>Estimate)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_ribbon">geom_ribbon</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">ymin=</span>Estimate <span class="op">-</span><span class="st"> `</span><span class="dt">Standard error of estimate</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                  <span class="dt">ymax=</span>Estimate <span class="op">+</span><span class="st"> `</span><span class="dt">Standard error of estimate</span><span class="st">`</span>, <span class="dt">fill=</span><span class="st">""</span>),</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">              <span class="dt">alpha=</span><span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">color=</span>GEO)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_y_continuous</a></span>(<span class="dt">labels=</span>scales<span class="op">::</span>percent) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_manual">scale_fill_manual</a></span>(<span class="dt">name =</span> <span class="st">""</span>, <span class="dt">values=</span><span class="st">"grey80"</span>, <span class="dt">label=</span><span class="st">"Standard error"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_bw</a></span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Comparison of unemployment rate by economic region"</span>,</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">       <span class="dt">y =</span> <span class="st">"Unemployment Rate"</span>, </a>
<a class="sourceLine" id="cb4-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">""</span>,</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">       <span class="dt">color =</span> <span class="st">""</span>,</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">       <span class="dt">caption=</span><span class="kw">paste0</span>(<span class="st">"CANSIM "</span>, selected_table))</a></code></pre></div>
<p><img src="listing_cansim_tables_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jens von Bergmann, Dmitry Shkolnik.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
